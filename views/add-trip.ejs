<!DOCTYPE html>
<html lang="en">

<head>

    <!-- SITE TITTLE -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Home We Same Way</title>

    <!-- PLUGINS CSS STYLE -->
    <link href="plugins/jquery-ui/jquery-ui.min.css" rel="stylesheet">
    <link href="plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <link href="plugins/listtyicons/style.css" rel="stylesheet">
    <link href="plugins/bootstrapthumbnail/bootstrap-thumbnail.css" rel="stylesheet">
    <link href="plugins/datepicker/datepicker.min.css" rel="stylesheet">
    <link href="plugins/selectbox/select_option1.css" rel="stylesheet">
    <link href="plugins/owl-carousel/owl.carousel.min.css" rel="stylesheet">
    <link href="plugins/fancybox/jquery.fancybox.pack.css" rel="stylesheet">
    <link href="plugins/isotope/isotope.min.css" rel="stylesheet">
    <link href="plugins/map/css/map.css" rel="stylesheet">

    <!-- GOOGLE FONT -->
    <link href="https://fonts.googleapis.com/css?family=Muli:200,300,400,600,700,800,900" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Herr+Von+Muellerhoff" rel="stylesheet">

    <!-- CUSTOM CSS -->
    <link href="css/style.css" rel="stylesheet">

    <!-- FAVICON -->
    <link href="img/favicon.png" rel="shortcut icon">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <title>Waypoints in directions</title>
    <style>
        #right-panel {
            font-family: 'Roboto', 'sans-serif';
            line-height: 30px;
            padding-left: 10px;
        }

        #right-panel select,
        #right-panel input {
            font-size: 15px;
        }

        #right-panel select {
            width: 100%;
        }

        #right-panel i {
            font-size: 12px;
        }

        html,
        body {
            height: 100%;
            margin: 0;
            padding: 0;
        }

        #map {
            height: 100%;
            float: left;
            width: 70%;
            height: 100%;
        }

        #right-panel {
            margin: 20px;
            border-width: 2px;
            width: 20%;
            height: 400px;
            float: left;
            text-align: left;
            padding-top: 0;
        }

        #directions-panel {
            margin-top: 10px;
            background-color: #FFEE77;
            padding: 10px;
            overflow: scroll;
            height: 174px;
        }
    </style>
</head>

<body class="body-wrapper">
    <div class="page-loader" style="background: url(img/preloader.gif) center no-repeat #fff;"></div>
    <div class="main-wrapper">
        <!-- HEADER -->
        <header id="pageTop" class="header">

            <!-- TOP INFO BAR -->

            <div class="nav-wrapper navbarWhite">

                <div class="container-fluid header-bg">
                    <div class="row">
                        <div class="col-lg-4 col-sm-4 col-xs-6 header-left empty">
                            empty
                        </div>
                        <div class="col-lg-8 col-sm-8 col-xs-6 header-right empty">
                            empty
                        </div>
                    </div>
                </div>

                <!-- NAVBAR -->

                <nav id="menuBar" class="navbar navbar-default lightHeader" role="navigation">
                    <div class="container">

                        <!-- Brand and toggle get grouped for better mobile display -->
                        <div class="navbar-header">
                            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                                <span class="sr-only">Toggle navigation</span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                            </button>
                            <a class="navbar-brand" href="index.html">
                                <img src="img/WeSameWay Logo.png" alt="logo">
                            </a>
                        </div>

                        <!-- Collect the nav links, forms, and other content for toggling -->
                        <div class="collapse navbar-collapse navbar-ex1-collapse">

                            <ul class="nav navbar-nav navbar-right">

                                <!--<li class=""><a href="search.html" style="font-weight:bolder">ค้นหารถ</a></li>-->
                                <!--<li class=""><a href="Profile.html" style="font-weight:bolder">ข้อมูลพาร์ทเนอร์</a></li>-->
                                <li class="">
                                    <a href="Truck.html" style="font-weight:bolder">สร้างข้อมูลรถ</a>
                                </li>
                                <li class="">
                                    <a href="Driver.html" style="font-weight:bolder">สร้างรายชื่อคนขับ</a>
                                </li>
                                <li class="">
                                    <a href="Route.html" style="font-weight:bolder">สร้างเส้นทาง</a>
                                </li>
                                <li class="active">
                                    <a href="Trip.html" style="font-weight:bolder">สร้างแผนการเดินทาง</a>
                                </li>

                            </ul>
                            <button type="button" class="btn btn-default navbar-btn" data-toggle="modal" data-target="#loginModal"> +
                                <span>ออกจากระบบ</span>
                            </button>

                        </div>

                    </div>
                </nav>
            </div>
            <div class="navbar-dashboard-area">
                <nav class="navbar navbar-default lightHeader navbar-dashboard" role="navigation">
                    <div class="container">
                        <!-- Brand and toggle get grouped for better mobile display -->
                        <div class="navbar-header">
                            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-dash">
                                <span class="sr-only">Toggle navigation</span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                            </button>
                        </div>
                        <!-- Collect the nav links, forms, and other content for toggling -->
                        <div class="collapse navbar-collapse navbar-dash">
                            <ul class="nav navbar-nav mr0">
                                <li class="active">
                                    <a href="dashboard.html">
                                        <i class="fa fa-tachometer icon-dash" aria-hidden="true"></i> หน้าหลักพาร์ทเนอร์</a>
                                </li>

                                <li>
                                    <a href="Completed_orders.html">
                                        <i class="fa fa-cogs icon-dash" aria-hidden="true"></i>รายการของส่งแล้ว</a>
                                </li>
                                <li>
                                    <a href="Pending_orders.html">
                                        <i class="fa fa-cogs icon-dash" aria-hidden="true"></i>รายการของรอการส่ง</a>
                                </li>
                                <li>
                                    <a href="Waiting_orders.html">
                                        <i class="fa fa-cogs icon-dash" aria-hidden="true"></i>รายการของรอการยืนยัน</a>
                                </li>
                                <li>
                                    <a href="dashboard.html#message" class="scrolling">
                                        <i class="fa fa-envelope icon-dash" aria-hidden="true"></i>ข้อความ</a>
                                </li>
                                <li>
                                    <a href="profile.html">
                                        <i class="fa fa-user icon-dash" aria-hidden="true"></i>แก้ไขข้อมูลพาร์ทเนอร์</a>
                                </li>
                            </ul>
                            <div class="row adjustRow">
                                <div class="pull-right col-xs-12 col-sm-2">
                                    <form class="navbar-form" role="search">
                                        <div class="input-group">
                                            <input type="text" class="form-control" placeholder="Search" name="q">
                                            <span class="input-group-btn">
                                                <button class="btn btn-default" type="button">
                                                    <i class="icon-listy icon-search-2"></i>
                                                </button>
                                            </span>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </nav>
            </div>
        </header>



        <!-- MAP SECTION -->






        <div class="dashboardBoxBg mb30">
            <div class="profileIntro">
                <div class="row">
                    <section class="clearfix p0 col-sm-8">
                        <div id="map-canvas"></div>

                    </section>
                    <div class="form-group col-md-4 col-sm-4 col-xs-12">

                        <div class="form-group col-md-12 col-sm-12 col-xs-12">
                            <label for="orderStatus">เลือกเส้นทางของคุณ</label>
                            <div class="contactSelect">

                                <select id="routeinfoes" name="routeinfoes" class="form-control" onchange="getRouteInfo()"  required>
                                    <% routeinfoes.forEach(function(routeinfo) { %>
                                        <option value="<%= routeinfo.id %>">
                                            <%= routeinfo.name %>
                                        </option>
                                        <% }); %>
                                </select>

                            </div>
                        </div>
                        <div class="form-group col-md-6 col-sm-6 col-xs-12">
                            <label for="orderStatus">เลือกประเภทรถ</label>
                            <!--<div  class="searchSelectbox" style="border-color: #e5e5e5;border-style:double">-->

                            <div class="contactSelect">
                                <select id="cartypes" name="cartypes" class="form-control" onchange="getTruck()" required>
                                    <% cartypes.forEach(function(cartype) { %>
                                        <option value="<%= cartype.id %>">
                                            <%= cartype.name %>
                                        </option>
                                        <% }); %>
                                </select>
                            </div>
                            <!--</div>-->
                        </div>
                        <div class="form-group col-md-6 col-sm-6 col-xs-12">
                            <label for="orderStatus">เลือกรถคันที่ใช้วิ่ง</label>
                            <div class="contactSelect">
                                <select id="truck" name="truck" class="form-control" required>
                                </select>
                            </div>

                        </div>
                        <div class="form-group col-md-12 col-sm-12 col-xs-12">
                            <label for="orderStatus">เลือกคนขับ</label>
                            <div class="contactSelect">

                                <select name="drivers" class="form-control" required>
                                    <% drivers.forEach(function(driver) { %>
                                        <option value="<%= driver.id %>">
                                            <%= driver.firstname %>
                                                <%= driver.lastname %>
                                        </option>
                                        <% }); %>
                                </select>
                            </div>

                        </div>

                        <div class="form-group col-md-12 col-sm-12 col-xs-12">
                            <label for="dateAdded">วันที่ส่งของ</label>
                            <div class="dateSelect">
                                <div class="input-group date ed-datepicker filterDate" data-provide="datepicker">
                                    <input id="depart_date" type="text" class="form-control" placeholder="yyyy-mm-dd">
                                    <div class="input-group-addon">
                                        <i class="icon-listy icon-calendar"></i>
                                    </div>

                                    <!--<div class="input-group-addon">
                    <i class="icon-listy icon-calendar"></i>
                </div>-->
                                </div>
                            </div>

                        </div>

                        <div class="form-group col-md-12 col-sm-12 col-xs-12">
                            <label for="orderStatus">วิ่งทุกวัน</label>
                            <div class="contactSelect">
                                <select name="day_name" id="day_name" class="form-control" multiple>
                                    <option value="0">วันจันทร์</option>
                                    <option value="1">วันอังคาร</option>
                                    <option value="2">วันพุธ</option>
                                    <option value="3">วันพฤหัส</option>
                                    <option value="4">วันศุกร์</option>
                                    <option value="5">วันเสาร์</option>
                                    <option value="6">วันอาทิตย์</option>


                                </select>
                            </div>

                        </div>

                        <div class="form-group col-md-12 col-md-offset-1 col-sm-12 col-xs-12">
                            <!--<button type="button" class="btn btn-primary" value="ดูเส้นทาง" style="text-align:center" id="submit" onclick="initMap()"> ดูเส้นทาง </button>-->
                            <button type="button" class="btn btn-primary" value="บันทึกการเดินทาง" style="text-align:center" id="save" onclick="saveMap()">
                                บันทึกเส้นทาง </button>
                        </div>

                    </div>


                </div>
            </div>
        </div>





        <!-- FOOTER -->
        <footer class="footerWhite">
            <!-- FOOTER INFO -->
            <div class="clearfix footerInfo">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-7 col-xs-12">
                            <div class="footerText">
                                <a href="index.html" class="footerLogo">
                                    <img src="img/logo-blue.png" alt="Footer Logo">
                                </a>
                                <p> ถูกกว่า สะดวกกว่า สินค้าปลอดภัย</p>
                                <ul class="list-styled list-contact">
                                    <li>
                                        <i class="fa fa-phone" aria-hidden="true"></i>[88] 657 524 332</li>
                                    <li>
                                        <i class="fa fa-envelope" aria-hidden="true"></i>
                                        <a href="#">info@wesameway.com</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-sm-3 col-xs-12">
                            <div class="footerInfoTitle">
                                <h4>Links</h4>
                            </div>
                            <div class="useLink">
                                <ul class="list-unstyled">
                                    <li>
                                        <a href="dashboard.html">หน้าสมาชิก</a>
                                    </li>
                                    <li>
                                        <a href="sign-up.html">หน้าพาร์ทเนอร์</a>
                                    </li>
                                    <li>
                                        <a href="login.html">สมัครสมาชิก</a>
                                    </li>

                                </ul>
                            </div>
                        </div>
                        <div class="col-sm-2 col-xs-12">
                            <div class="footerInfoTitle">
                                <h4>Company</h4>
                            </div>
                            <div class="useLink">
                                <ul class="list-unstyled">
                                    <li>
                                        <a href="contact-us.html">ติดต่อเรา</a>
                                    </li>
                                    <li>
                                        <a href="terms-of-services.html">ข้อตกลงและเงื่อนไข</a>
                                    </li>
                                    <li>
                                        <a href="how-it-works.html">การใช้งาน</a>
                                    </li>
                                    <li>
                                        <a href="payment-process.html">การชำระเงิน</a>
                                    </li>
                                    <li>
                                        <a href="pricing-table.html">เราแตกต่างจากที่อื่นอย่างไร</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- COPY RIGHT -->
            <div class="clearfix copyRight">
                <div class="container">
                    <div class="row">
                        <div class="col-xs-12">
                            <div class="copyRightWrapper">
                                <div class="row">
                                    <div class="col-sm-5 col-sm-push-7 col-xs-12">
                                        <ul class="list-inline socialLink">
                                            <li>
                                                <a href="#">
                                                    <i class="fa fa-facebook" aria-hidden="true"></i>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#">
                                                    <i class="fa fa-twitter" aria-hidden="true"></i>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#">
                                                    <i class="fa fa-pinterest-p" aria-hidden="true"></i>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#">
                                                    <i class="fa fa-linkedin" aria-hidden="true"></i>
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="col-sm-7 col-sm-pull-5 col-xs-12">
                                        <div class="copyRightText">
                                            <p>Copyright &copy; 2017. All Rights Reserved by
                                                <a href="http://www.wesameway.com/" target="_blank">We Same Way</a>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </footer>
    </div>

    <!-- LOGIN  MODAL -->
    <div id="loginModal" tabindex="-1" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">กรุณา Log in เพื่อ เข้าสู่ระบบ</h4>
                </div>
                <div class="modal-body">
                    <form class="loginForm">
                        <div class="form-group">
                            <i class="fa fa-envelope" aria-hidden="true"></i>
                            <input type="email" class="form-control" id="email" placeholder="อีเมลล์หรือเบอร์โทรศัพท์">
                        </div>
                        <div class="form-group">
                            <i class="fa fa-lock" aria-hidden="true"></i>
                            <input type="password" class="form-control" id="pwd" placeholder="Password">
                        </div>
                        <div class="form-group">
                            <button type="submit" class="btn btn-primary btn-block">Log In</button>
                        </div>
                        <div class="checkbox">
                            <label>
                                <input type="checkbox"> Remember me</label>
                            <a href="#" class="pull-right link">ลืมพาร์ดเวิอร์ด?</a>
                        </div>

                    </form>
                </div>
                <div class="modal-footer">
                    <p>ยังไม่ได้เป็นสมาชิก?
                        <a href="#" class="link">ลงทะเบียน</a>
                    </p>
                </div>
            </div>

        </div>
    </div>

    <!-- JAVASCRIPTS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="plugins/jquery/jquery.min.js"></script>
    <script src="plugins/jquery-ui/jquery-ui.min.js"></script>
    <script src="plugins/bootstrap/js/bootstrap.min.js"></script>
    <script src="plugins/smoothscroll/SmoothScroll.min.js"></script>
    <script src="plugins/waypoints/waypoints.min.js"></script>
    <script src="plugins/counter-up/jquery.counterup.min.js"></script>
    <script src="plugins/datepicker/bootstrap-datepicker.min.js"></script>
    <script src="plugins/selectbox/jquery.selectbox-0.1.3.min.js"></script>
    <script src="plugins/owl-carousel/owl.carousel.min.js"></script>
    <script src="plugins/isotope/isotope.min.js"></script>
    <script src="plugins/fancybox/jquery.fancybox.pack.js"></script>
    <script src="plugins/isotope/isotope-triger.min.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC7_JFbQgIarSxSuPVcwJvkT0wEmJlUSZw&;callback=initMap&language=th"></script>
    <script src="plugins/map/js/rich-marker.js"></script>
    <script src="plugins/map/js/infobox_packed.js"></script>
    <script src="javascript/map.js"></script>
    <script src="javascript/custom.js"></script>
    <script>

        var url = window.location.origin
        $(document).ready(function () {


            getRouteInfo()
            getTruck()

            $(".ed-datepicker").datepicker({
                format: 'yyyy-mm-dd'
            });
        });



        function getRouteInfo() {

            var routeinfo = document.getElementById("routeinfoes").value;
            var endpoint = url + "/routeinfo/" + routeinfo

            console.log(endpoint)

            $.get(endpoint, function (data) {

                if (data.length > 0) {
                    //Render waypoint to map
                    //console.log(data)
                    initMap(data)
                } else {
                    alert("--ไม่มีข้อมูลเส้นทางนี้--")
                }
            });
        }

        function initMap(data) {

            var directionsService = new google.maps.DirectionsService;
            var directionsDisplay = new google.maps.DirectionsRenderer({
                draggable: true,
                map: map

            });

            var map = new google.maps.Map(document.getElementById('map-canvas'), {
                zoom: 7

            });

            directionsDisplay.setMap(map);
            var waypts = [];
            var stoppoint1 = data[0].stoppoint1;
            console.log(stoppoint1)
            var stoppoint2 = data[0].stoppoint2;
            console.log(stoppoint2)
            var stoppoint3 = data[0].stoppoint3;
            console.log(stoppoint3)
            var stoppoint4 = data[0].stoppoint4;
            console.log(stoppoint4)
            var stoppoint5 = data[0].stoppoint5;
            console.log(stoppoint5)
            var stoppoint6 = data[0].stoppoint6;
            console.log(stoppoint6)
            if (stoppoint1 != "") {
                waypts.push({
                    location: stoppoint1,
                    stopover: true
                });
            }
            if (stoppoint2 != "") {
                waypts.push({
                    location: stoppoint2,
                    stopover: true
                });
            }
            if (stoppoint3 != "") {
                waypts.push({
                    location: stoppoint3,
                    stopover: true
                });
            }
            if (stoppoint4 != "") {
                waypts.push({
                    location: stoppoint4,
                    stopover: true
                });
            }
            if (stoppoint5 != "") {
                waypts.push({
                    location: stoppoint5,
                    stopover: true
                });
            }
            if (stoppoint6 != "") {
                waypts.push({
                    location: stoppoint6,
                    stopover: true
                });
            }

            var startpoint = data[0].startpoint
            console.log(startpoint)
            var endpoint = data[0].endpoint
            console.log(endpoint)

            directionsService.route({
                origin: startpoint,
                destination: endpoint,
                travelMode: 'DRIVING',
                waypoints: waypts,
                optimizeWaypoints: true

            }, function (response, status) {

                console.log(response)
                if (status === 'OK') {
                    directionsDisplay.setDirections(response);
                    // var route = response.routes[0];
                    // var summaryPanel = document.getElementById('directions-panel');
                    // summaryPanel.innerHTML = '';
                    // // For each route, display summary information.
                    // for (var i = 0; i < route.legs.length; i++) {
                    //     var routeSegment = i + 1;
                    //     summaryPanel.innerHTML += '<b>Route Segment: ' + routeSegment +
                    //         '</b><br>';
                    //     summaryPanel.innerHTML += route.legs[i].start_address + ' to ';
                    //     summaryPanel.innerHTML += route.legs[i].end_address + '<br>';
                    //     summaryPanel.innerHTML += route.legs[i].distance.text + '<br><br>';
                    // }

                }

                else {
                    window.alert('Directions request failed due to ' + status);
                }
            });
        }



        function getTruck() {
            $('#truck').empty()
            var cartype = document.getElementById("cartypes").value;
            var endpoint = url + "/truck/cartype/" + cartype + "/partner/1"


            $.get(endpoint, function (data) {

                if (data.length > 0) {

                    for (var i = 0; i < data.length; i++) {
                        console.log(data[i].id + " : " + data[i].name)
                        $('#truck').append(new Option(data[i].plate_no, data[i].id));
                    }
                } else {
                    $('#truck').append(new Option("--ไม่มีรถประเภทนี้--", 0));
                }
            });
        }

    </script>

</body>

</html>